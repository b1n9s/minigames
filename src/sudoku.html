<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>Sudoku - A Little Fun</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Play kid-friendly Sudoku puzzles! Easy 4x4 grids perfect for children learning numbers and logic. Colorful and engaging puzzle game.">
    <meta name="keywords" content="sudoku game, kids puzzle, 4x4 sudoku, number puzzle, logic game, children's sudoku, easy sudoku">
    <meta name="author" content="b1n9s">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Sudoku - A Little Fun">
    <meta property="og:description" content="Play kid-friendly Sudoku puzzles! Easy 4x4 grids perfect for children learning numbers and logic.">
    <meta property="og:url" content="https://alittl.fun/sudoku.html">
    <meta property="og:type" content="website">
    
    <!-- Theme -->
    <meta name="theme-color" content="#8e44ad">
    
    <style>
        * {
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        html, body {
            overflow-x: hidden;
            position: relative;
        }

        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #8e44ad 0%, #3498db 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: white;
            user-select: none;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 3em;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            margin-top: 10px;
            font-size: 1.1em;
            opacity: 0.9;
        }

        .game-info {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
            font-size: 1.2em;
        }

        .info-panel {
            background: rgba(255,255,255,0.2);
            padding: 15px 25px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .info-label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 1.5em;
            font-weight: bold;
        }

        .difficulty-selector {
            margin-bottom: 20px;
            text-align: center;
        }

        .difficulty-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 10px 20px;
            margin: 0 5px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
        }

        .difficulty-btn.active {
            background: rgba(255,255,255,0.4);
            border-color: rgba(255,255,255,0.6);
        }

        .difficulty-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .game-container {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .sudoku-grid {
            display: grid;
            gap: 3px;
            background: #34495e;
            border-radius: 15px;
            padding: 15px;
            margin: 0 auto 20px auto;
        }

        .grid-3x3 {
            grid-template-columns: repeat(3, 1fr);
            width: 240px;
            height: 240px;
        }

        .grid-4x4 {
            grid-template-columns: repeat(4, 1fr);
            width: 280px;
            height: 280px;
        }

        .grid-9x9 {
            grid-template-columns: repeat(9, 1fr);
            width: 450px;
            height: 450px;
            gap: 0;
        }

        .sudoku-cell {
            background: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            color: #2c3e50;
            border: 2px solid #bdc3c7;
        }

        /* Simple borders for 3x3 grid (no sub-boxes) */
        .grid-3x3 .sudoku-cell {
            border: 2px solid #bdc3c7;
        }
        
        .grid-3x3 .sudoku-cell:nth-child(-n+3) {
            border-top: 4px solid #2c3e50;
        }
        
        .grid-3x3 .sudoku-cell:nth-child(3n+1) {
            border-left: 4px solid #2c3e50;
        }
        
        .grid-3x3 .sudoku-cell:nth-child(3n) {
            border-right: 4px solid #2c3e50;
        }
        
        .grid-3x3 .sudoku-cell:nth-child(n+7) {
            border-bottom: 4px solid #2c3e50;
        }

        /* Box boundaries for 4x4 grid (2x2 boxes) */
        .grid-4x4 .sudoku-cell:nth-child(1),
        .grid-4x4 .sudoku-cell:nth-child(2) {
            border-top: 4px solid #2c3e50;
        }
        
        .grid-4x4 .sudoku-cell:nth-child(1),
        .grid-4x4 .sudoku-cell:nth-child(3) {
            border-left: 4px solid #2c3e50;
        }
        
        .grid-4x4 .sudoku-cell:nth-child(2),
        .grid-4x4 .sudoku-cell:nth-child(4) {
            border-right: 4px solid #2c3e50;
        }
        
        .grid-4x4 .sudoku-cell:nth-child(3),
        .grid-4x4 .sudoku-cell:nth-child(4) {
            border-bottom: 4px solid #2c3e50;
        }
        
        .grid-4x4 .sudoku-cell:nth-child(5),
        .grid-4x4 .sudoku-cell:nth-child(6) {
            border-top: 4px solid #2c3e50;
        }
        
        .grid-4x4 .sudoku-cell:nth-child(5),
        .grid-4x4 .sudoku-cell:nth-child(7) {
            border-left: 4px solid #2c3e50;
        }
        
        .grid-4x4 .sudoku-cell:nth-child(6),
        .grid-4x4 .sudoku-cell:nth-child(8) {
            border-right: 4px solid #2c3e50;
        }
        
        .grid-4x4 .sudoku-cell:nth-child(7),
        .grid-4x4 .sudoku-cell:nth-child(8) {
            border-bottom: 4px solid #2c3e50;
        }
        
        .grid-4x4 .sudoku-cell:nth-child(9),
        .grid-4x4 .sudoku-cell:nth-child(10) {
            border-top: 4px solid #2c3e50;
        }
        
        .grid-4x4 .sudoku-cell:nth-child(9),
        .grid-4x4 .sudoku-cell:nth-child(11) {
            border-left: 4px solid #2c3e50;
        }
        
        .grid-4x4 .sudoku-cell:nth-child(10),
        .grid-4x4 .sudoku-cell:nth-child(12) {
            border-right: 4px solid #2c3e50;
        }
        
        .grid-4x4 .sudoku-cell:nth-child(11),
        .grid-4x4 .sudoku-cell:nth-child(12) {
            border-bottom: 4px solid #2c3e50;
        }
        
        .grid-4x4 .sudoku-cell:nth-child(13),
        .grid-4x4 .sudoku-cell:nth-child(14) {
            border-top: 4px solid #2c3e50;
        }
        
        .grid-4x4 .sudoku-cell:nth-child(13),
        .grid-4x4 .sudoku-cell:nth-child(15) {
            border-left: 4px solid #2c3e50;
        }
        
        .grid-4x4 .sudoku-cell:nth-child(14),
        .grid-4x4 .sudoku-cell:nth-child(16) {
            border-right: 4px solid #2c3e50;
        }
        
        .grid-4x4 .sudoku-cell:nth-child(15),
        .grid-4x4 .sudoku-cell:nth-child(16) {
            border-bottom: 4px solid #2c3e50;
        }

        /* Box boundaries for 9x9 grid using data attributes */
        .grid-9x9 .sudoku-cell {
            border-right: 2px solid #bdc3c7;
            border-bottom: 2px solid #bdc3c7;
        }
        
        /* Thick borders for 3x3 box separations */
        .grid-9x9 .sudoku-cell[data-col="2"],
        .grid-9x9 .sudoku-cell[data-col="5"] {
            border-right: 4px solid #2c3e50;
        }
        
        .grid-9x9 .sudoku-cell[data-row="2"],
        .grid-9x9 .sudoku-cell[data-row="5"] {
            border-bottom: 4px solid #2c3e50;
        }
        
        /* Outer borders */
        .grid-9x9 .sudoku-cell[data-row="0"] {
            border-top: 4px solid #2c3e50;
        }
        
        .grid-9x9 .sudoku-cell[data-col="0"] {
            border-left: 4px solid #2c3e50;
        }
        
        .grid-9x9 .sudoku-cell[data-col="8"] {
            border-right: 4px solid #2c3e50;
        }
        
        .grid-9x9 .sudoku-cell[data-row="8"] {
            border-bottom: 4px solid #2c3e50;
        }

        .grid-3x3 .sudoku-cell {
            width: 70px;
            height: 70px;
        }

        .grid-4x4 .sudoku-cell {
            width: 60px;
            height: 60px;
        }

        .grid-9x9 .sudoku-cell {
            width: 45px;
            height: 45px;
            font-size: 1.4em;
        }

        .sudoku-cell:hover {
            background: #e8f4fd;
            transform: scale(1.05);
        }

        .sudoku-cell.selected {
            background: #3498db;
            color: white;
            box-shadow: 0 0 15px rgba(52, 152, 219, 0.5);
        }

        .sudoku-cell.given {
            background: #3498db;
            color: white;
            cursor: default;
            font-weight: 900;
        }

        .sudoku-cell.given:hover {
            background: #3498db;
            transform: none;
        }

        .sudoku-cell.user-input {
            background: white;
            color: #8e44ad;
            font-weight: bold;
        }

        .sudoku-cell.conflict {
            background: #e74c3c;
            color: white;
            animation: shake 0.5s ease-in-out;
        }

        .sudoku-cell.correct {
            background: #27ae60;
            color: white;
            animation: bounce 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .number-pad {
            display: grid;
            gap: 10px;
            margin-bottom: 20px;
            justify-items: center;
        }

        .pad-3x3 {
            grid-template-columns: repeat(3, 1fr);
        }

        .pad-4x4 {
            grid-template-columns: repeat(4, 1fr);
        }

        .pad-9x9 {
            grid-template-columns: repeat(9, 1fr);
        }

        .number-btn {
            background: #3498db;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.5em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .pad-3x3 .number-btn {
            width: 70px;
            height: 70px;
        }

        .pad-4x4 .number-btn {
            width: 60px;
            height: 60px;
        }

        .pad-9x9 .number-btn {
            width: 45px;
            height: 45px;
            font-size: 1.2em;
        }

        .number-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .number-btn:active {
            transform: translateY(0);
        }

        .controls {
            text-align: center;
        }

        .game-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1.1em;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
            margin: 5px;
        }

        .game-btn:hover {
            background: #2ecc71;
        }

        .game-btn.danger {
            background: #e74c3c;
        }

        .game-btn.danger:hover {
            background: #c0392b;
        }

        .instructions {
            margin-top: 20px;
            text-align: center;
            opacity: 0.8;
            font-size: 0.9em;
            max-width: 400px;
            color: #2c3e50;
        }

        .home-link {
            position: absolute;
            top: 20px;
            left: 20px;
            color: white;
            text-decoration: none;
            font-size: 1.1em;
            padding: 10px;
            background: rgba(255,255,255,0.2);
            border-radius: 5px;
            backdrop-filter: blur(10px);
            transition: background 0.3s;
        }

        .home-link:hover {
            background: rgba(255,255,255,0.3);
        }

        .sound-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            font-size: 1.5em;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: white;
            cursor: pointer;
            padding: 10px 15px;
            transition: all 0.3s ease;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .sound-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .win-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            text-align: center;
            z-index: 1000;
            display: none;
        }

        .win-message.show {
            display: block;
            animation: popIn 0.5s ease-out;
        }

        @keyframes popIn {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        .win-title {
            font-size: 2.5em;
            color: #27ae60;
            margin-bottom: 20px;
        }

        .win-stats {
            font-size: 1.2em;
            color: #2c3e50;
            margin-bottom: 30px;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }

        .overlay.show {
            display: block;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.5em;
            color: #7f8c8d;
            cursor: pointer;
            padding: 5px;
        }

        .close-btn:hover {
            color: #2c3e50;
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2.5em;
            }
            
            .game-info {
                gap: 15px;
                font-size: 1em;
            }
            
            .info-panel {
                padding: 10px 15px;
            }

            .game-container {
                padding: 20px;
            }

            .grid-3x3 {
                width: 210px;
                height: 210px;
            }

            .grid-3x3 .sudoku-cell {
                width: 60px;
                height: 60px;
                font-size: 1.8em;
            }

            .pad-3x3 .number-btn {
                width: 60px;
                height: 60px;
                font-size: 1.4em;
            }

            .grid-4x4 {
                width: 240px;
                height: 240px;
            }

            .grid-4x4 .sudoku-cell {
                width: 50px;
                height: 50px;
                font-size: 1.5em;
            }

            .pad-4x4 .number-btn {
                width: 50px;
                height: 50px;
                font-size: 1.2em;
            }

            .grid-9x9 {
                width: 320px;
                height: 320px;
            }

            .grid-9x9 .sudoku-cell {
                width: 30px;
                height: 30px;
                font-size: 1em;
            }

            .pad-9x9 .number-btn {
                width: 30px;
                height: 30px;
                font-size: 0.9em;
            }

            .sound-btn {
                top: 10px;
                right: 10px;
                font-size: 1.2em;
                padding: 8px 12px;
            }
        }
    </style>
</head>
<body>
    <a href="index.html" class="home-link">← Home</a>
    <button class="sound-btn" onclick="toggleSound()" id="soundBtn">🔊</button>
    
    <div class="header">
        <h1>🧩 Sudoku</h1>
        <div class="subtitle">Fill the grid with numbers!</div>
    </div>

    <div class="difficulty-selector">
        <button class="difficulty-btn active" onclick="setDifficulty('3x3')" id="btn3x3">Beginner (3×3)</button>
        <button class="difficulty-btn" onclick="setDifficulty('4x4')" id="btn4x4">Easy (4×4)</button>
        <button class="difficulty-btn" onclick="setDifficulty('9x9')" id="btn9x9">Classic (9×9)</button>
    </div>

    <div class="game-info">
        <div class="info-panel">
            <div class="info-label">TIME</div>
            <div class="info-value" id="timer">0:00</div>
        </div>
        <div class="info-panel">
            <div class="info-label">HINTS</div>
            <div class="info-value" id="hints">3</div>
        </div>
    </div>

    <div class="game-container">
        <div class="sudoku-grid grid-3x3" id="sudokuGrid"></div>
        
        <div class="number-pad pad-3x3" id="numberPad"></div>
        
        <div class="controls">
            <button class="game-btn" onclick="game.newGame()">New Game</button>
            <button class="game-btn" onclick="game.getHint()" id="hintBtn">Get Hint</button>
            <button class="game-btn danger" onclick="game.clearCell()">Clear</button>
        </div>

        <div class="instructions">
            <strong>HOW TO PLAY:</strong> Fill each row and column with numbers (1-3 for 3×3, 1-4 for 4×4, or 1-9 for 9×9). 
            Each number can only appear once in each row and column. For 4×4 and 9×9, numbers also can't repeat in each box. Tap a cell, then tap a number!
        </div>
    </div>

    <div class="overlay" id="overlay"></div>
    <div class="win-message" id="winMessage">
        <button class="close-btn" onclick="closeWinMessage()">✕</button>
        <div class="win-title">🎉 Awesome!</div>
        <div class="win-stats" id="winStats"></div>
        <div class="win-controls">
            <button class="game-btn" onclick="playAgain()">Play Again</button>
        </div>
    </div>

    <script>
        class SudokuGame {
            constructor() {
                this.gridSize = 3;
                this.boxSize = 1;
                this.grid = [];
                this.solution = [];
                this.given = [];
                this.selectedCell = null;
                this.timer = 0;
                this.timerInterval = null;
                this.hintsLeft = 3;
                this.startTime = null;
                
                this.gridElement = document.getElementById('sudokuGrid');
                this.padElement = document.getElementById('numberPad');
                this.timerElement = document.getElementById('timer');
                this.hintsElement = document.getElementById('hints');
                
                this.init();
            }
            
            init() {
                this.grid = Array(this.gridSize).fill(null).map(() => Array(this.gridSize).fill(0));
                this.given = Array(this.gridSize).fill(null).map(() => Array(this.gridSize).fill(false));
                this.selectedCell = null;
                this.timer = 0;
                this.hintsLeft = 3;
                this.startTime = Date.now();
                
                this.generatePuzzle();
                this.createGrid();
                this.createNumberPad();
                this.updateDisplay();
                this.startTimer();
            }
            
            generatePuzzle() {
                // Generate a complete valid solution first
                this.solution = Array(this.gridSize).fill(null).map(() => Array(this.gridSize).fill(0));
                this.fillGrid(this.solution);
                
                // Copy solution to grid and remove some numbers
                for (let r = 0; r < this.gridSize; r++) {
                    for (let c = 0; c < this.gridSize; c++) {
                        this.grid[r][c] = this.solution[r][c];
                    }
                }
                
                // Remove numbers to create puzzle (keep about 40-50% filled)
                const cellsToRemove = Math.floor(this.gridSize * this.gridSize * 0.5);
                for (let i = 0; i < cellsToRemove; i++) {
                    let r, c;
                    do {
                        r = Math.floor(Math.random() * this.gridSize);
                        c = Math.floor(Math.random() * this.gridSize);
                    } while (this.grid[r][c] === 0);
                    
                    this.grid[r][c] = 0;
                }
                
                // Mark given cells
                for (let r = 0; r < this.gridSize; r++) {
                    for (let c = 0; c < this.gridSize; c++) {
                        this.given[r][c] = this.grid[r][c] !== 0;
                    }
                }
            }
            
            fillGrid(grid) {
                for (let r = 0; r < this.gridSize; r++) {
                    for (let c = 0; c < this.gridSize; c++) {
                        if (grid[r][c] === 0) {
                            const numbers = this.shuffleArray([...Array(this.gridSize)].map((_, i) => i + 1));
                            
                            for (const num of numbers) {
                                if (this.isValidMove(grid, r, c, num)) {
                                    grid[r][c] = num;
                                    if (this.fillGrid(grid)) {
                                        return true;
                                    }
                                    grid[r][c] = 0;
                                }
                            }
                            return false;
                        }
                    }
                }
                return true;
            }
            
            shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }
            
            isValidMove(grid, row, col, num) {
                // Check row
                for (let c = 0; c < this.gridSize; c++) {
                    if (grid[row][c] === num) return false;
                }
                
                // Check column
                for (let r = 0; r < this.gridSize; r++) {
                    if (grid[r][col] === num) return false;
                }
                
                // Check box (only for grids with boxSize > 1)
                if (this.boxSize > 1) {
                    const boxRow = Math.floor(row / this.boxSize) * this.boxSize;
                    const boxCol = Math.floor(col / this.boxSize) * this.boxSize;
                    
                    for (let r = boxRow; r < boxRow + this.boxSize; r++) {
                        for (let c = boxCol; c < boxCol + this.boxSize; c++) {
                            if (grid[r][c] === num) return false;
                        }
                    }
                }
                
                return true;
            }
            
            createGrid() {
                this.gridElement.innerHTML = '';
                this.gridElement.className = `sudoku-grid grid-${this.gridSize}x${this.gridSize}`;
                
                for (let r = 0; r < this.gridSize; r++) {
                    for (let c = 0; c < this.gridSize; c++) {
                        const cell = document.createElement('div');
                        cell.className = 'sudoku-cell';
                        cell.dataset.row = r;
                        cell.dataset.col = c;
                        
                        if (this.given[r][c]) {
                            cell.classList.add('given');
                            cell.textContent = this.grid[r][c];
                        } else {
                            cell.addEventListener('click', () => this.selectCell(r, c));
                            if (this.grid[r][c] !== 0) {
                                cell.textContent = this.grid[r][c];
                                cell.classList.add('user-input');
                            }
                        }
                        
                        this.gridElement.appendChild(cell);
                    }
                }
            }
            
            createNumberPad() {
                this.padElement.innerHTML = '';
                this.padElement.className = `number-pad pad-${this.gridSize}x${this.gridSize}`;
                
                for (let i = 1; i <= this.gridSize; i++) {
                    const btn = document.createElement('button');
                    btn.className = 'number-btn';
                    btn.textContent = i;
                    btn.addEventListener('click', () => this.placeNumber(i));
                    this.padElement.appendChild(btn);
                }
            }
            
            selectCell(row, col) {
                if (this.given[row][col]) return;
                
                // Remove previous selection
                const prevSelected = this.gridElement.querySelector('.selected');
                if (prevSelected) {
                    prevSelected.classList.remove('selected');
                }
                
                this.selectedCell = { row, col };
                const cell = this.gridElement.children[row * this.gridSize + col];
                cell.classList.add('selected');
                
                this.playClickSound();
            }
            
            placeNumber(num) {
                if (!this.selectedCell) return;
                
                const { row, col } = this.selectedCell;
                if (this.given[row][col]) return;
                
                const cell = this.gridElement.children[row * this.gridSize + col];
                
                // Clear any previous styling
                cell.classList.remove('conflict', 'correct');
                
                if (this.isValidMove(this.grid, row, col, num)) {
                    this.grid[row][col] = num;
                    cell.textContent = num;
                    cell.classList.add('correct', 'user-input');
                    
                    this.playSuccessSound();
                    
                    // Check if puzzle is complete
                    setTimeout(() => {
                        cell.classList.remove('correct');
                        if (this.isPuzzleComplete()) {
                            this.showWin();
                        }
                    }, 500);
                } else {
                    // Show conflict briefly
                    const oldValue = this.grid[row][col];
                    this.grid[row][col] = num;
                    cell.textContent = num;
                    cell.classList.add('conflict');
                    
                    this.playErrorSound();
                    
                    setTimeout(() => {
                        this.grid[row][col] = oldValue;
                        cell.textContent = oldValue || '';
                        cell.classList.remove('conflict');
                        if (oldValue !== 0) {
                            cell.classList.add('user-input');
                        }
                    }, 800);
                }
            }
            
            clearCell() {
                if (!this.selectedCell) return;
                
                const { row, col } = this.selectedCell;
                if (this.given[row][col]) return;
                
                this.grid[row][col] = 0;
                const cell = this.gridElement.children[row * this.gridSize + col];
                cell.textContent = '';
                cell.classList.remove('conflict', 'correct', 'user-input');
                
                this.playClickSound();
            }
            
            getHint() {
                if (this.hintsLeft <= 0) return;
                
                // Find empty cells
                const emptyCells = [];
                for (let r = 0; r < this.gridSize; r++) {
                    for (let c = 0; c < this.gridSize; c++) {
                        if (this.grid[r][c] === 0) {
                            emptyCells.push({ r, c });
                        }
                    }
                }
                
                if (emptyCells.length === 0) return;
                
                // Pick a random empty cell and fill it with the correct number
                const randomCell = emptyCells[Math.floor(Math.random() * emptyCells.length)];
                const { r, c } = randomCell;
                
                this.grid[r][c] = this.solution[r][c];
                const cell = this.gridElement.children[r * this.gridSize + c];
                cell.textContent = this.solution[r][c];
                cell.classList.add('correct');
                
                this.hintsLeft--;
                this.updateDisplay();
                
                this.playHintSound();
                
                setTimeout(() => {
                    cell.classList.remove('correct');
                    if (this.isPuzzleComplete()) {
                        this.showWin();
                    }
                }, 500);
            }
            
            isPuzzleComplete() {
                for (let r = 0; r < this.gridSize; r++) {
                    for (let c = 0; c < this.gridSize; c++) {
                        if (this.grid[r][c] === 0) return false;
                    }
                }
                return true;
            }
            
            showWin() {
                this.stopTimer();
                const elapsed = Math.floor((Date.now() - this.startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                
                document.getElementById('winStats').innerHTML = `
                    You completed the ${this.gridSize}×${this.gridSize} puzzle in ${minutes}:${seconds.toString().padStart(2, '0')}!<br>
                    Hints used: ${3 - this.hintsLeft}/3
                `;
                
                document.getElementById('overlay').classList.add('show');
                document.getElementById('winMessage').classList.add('show');
                
                this.playWinSound();
            }
            
            startTimer() {
                this.stopTimer();
                this.timerInterval = setInterval(() => {
                    this.timer++;
                    const minutes = Math.floor(this.timer / 60);
                    const seconds = this.timer % 60;
                    this.timerElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                }, 1000);
            }
            
            stopTimer() {
                if (this.timerInterval) {
                    clearInterval(this.timerInterval);
                    this.timerInterval = null;
                }
            }
            
            updateDisplay() {
                this.hintsElement.textContent = this.hintsLeft;
                const hintBtn = document.getElementById('hintBtn');
                hintBtn.disabled = this.hintsLeft <= 0;
                if (this.hintsLeft <= 0) {
                    hintBtn.textContent = 'No Hints';
                }
            }
            
            newGame() {
                this.stopTimer();
                this.init();
            }

            // Sound effects
            playClickSound() {
                if (!soundEnabled) return;
                this.playTone(300, 0.1, 0.1);
            }

            playSuccessSound() {
                if (!soundEnabled) return;
                this.playTone(440, 0.15, 0.2);
            }

            playErrorSound() {
                if (!soundEnabled) return;
                this.playTone(200, 0.2, 0.3);
            }

            playHintSound() {
                if (!soundEnabled) return;
                const audioContext = new (AudioContext || webkitAudioContext)();
                const notes = [523.25, 659.25, 783.99]; // C5, E5, G5
                notes.forEach((frequency, index) => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime + index * 0.1);
                    gainNode.gain.setValueAtTime(0.1, audioContext.currentTime + index * 0.1);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + index * 0.1 + 0.2);
                    
                    oscillator.start(audioContext.currentTime + index * 0.1);
                    oscillator.stop(audioContext.currentTime + index * 0.1 + 0.2);
                });
            }

            playWinSound() {
                if (!soundEnabled) return;
                const audioContext = new (AudioContext || webkitAudioContext)();
                const notes = [523.25, 659.25, 783.99, 1046.50, 783.99, 1046.50]; // Happy melody
                notes.forEach((frequency, index) => {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime + index * 0.2);
                    gainNode.gain.setValueAtTime(0.15, audioContext.currentTime + index * 0.2);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + index * 0.2 + 0.3);
                    
                    oscillator.start(audioContext.currentTime + index * 0.2);
                    oscillator.stop(audioContext.currentTime + index * 0.2 + 0.3);
                });
            }

            playTone(frequency, gain, duration) {
                if (typeof AudioContext === 'undefined' && typeof webkitAudioContext === 'undefined') return;
                
                const audioContext = new (AudioContext || webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                gainNode.gain.setValueAtTime(gain, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + duration);
            }
        }

        // Game difficulty management
        function setDifficulty(difficulty) {
            // Update button states
            document.querySelectorAll('.difficulty-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`btn${difficulty}`).classList.add('active');
            
            // Update game settings
            if (difficulty === '3x3') {
                game.gridSize = 3;
                game.boxSize = 1; // 3x3 has no sub-boxes, only rows and columns
            } else if (difficulty === '4x4') {
                game.gridSize = 4;
                game.boxSize = 2;
            } else if (difficulty === '9x9') {
                game.gridSize = 9;
                game.boxSize = 3; // 9x9 uses 3x3 boxes
            }
            
            // Start new game with new difficulty
            game.newGame();
        }

        // Sound control
        let soundEnabled = true;

        function toggleSound() {
            soundEnabled = !soundEnabled;
            document.getElementById('soundBtn').textContent = soundEnabled ? '🔊' : '🔇';
        }

        // Win message functions
        function closeWinMessage() {
            document.getElementById('overlay').classList.remove('show');
            document.getElementById('winMessage').classList.remove('show');
        }

        function playAgain() {
            closeWinMessage();
            game.newGame();
        }
        
        // Initialize game
        const game = new SudokuGame();
    </script>
</body>
</html>